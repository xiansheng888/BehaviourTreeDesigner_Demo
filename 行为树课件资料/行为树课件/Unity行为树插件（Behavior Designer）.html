<html>
<head>
  <title>Unity行为树插件（Behavior Designer）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/607711 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1392"/>
<h1>Unity行为树插件（Behavior Designer）</h1>

<div>
<span><div style="text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">1. 当AI足够复杂的时候 我发现此时的FMS已经被写成了一片代码的泥沼，想要继续维护下去已经是很乏力了</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">2. 当我们使用Unity自带的动画状态机系统后，变成了这样 下图 ，当然你想改也不是不可以或许是个体力活，但是我想告诉你，你的队友可能在某些动画之中安插了一些 被称为 动画帧事件 的东西，而这种东西则需要你一个一个选中并且查看动画文件是否被更改，量一旦大了换一个人接手那就是“不可能实现的任务”</span></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824316607019.png"><img src="Unity行为树插件（Behavior Designer）_files/Image.png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard" width="244"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-weight: bold;">基本概念</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824333481003.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [1].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[1]" width="228"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-weight: bold;">Composites</span></div><div><br/></div><div style="text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        这里的&quot;组合&quot; 全名应该被成为“组合节点控制(管理)类目”，顾名思义在此条目下若干个选项都被称之为“控制类节点”，用以从最高的纬度去规范行为树的流程。具体细分为如下几种</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824340829846.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [2].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[2]" width="244"/></a></div><div><br/></div><div style="text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">    Parallel 并行节点    此节点下属所有节点将一起进行，其中某一个执行返回false 则Parallel节点返回false</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">    Parallel Selector 并行选择节点    此节点下属所有节点只要有一个返回success，则Parallel Selector节点返回success</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        注意： 以上二节点都是并行的，也就是说同时执行所有下属节点</span></div><div><br/></div><div style="text-align: left;"><div><a href="http://images0.cnblogs.com/blog/545402/201508/131824350671445.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [3].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[3]" width="242"/></a></div><div><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;"> </span><a href="http://images0.cnblogs.com/blog/545402/201508/131824359897530.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [4].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[4]" width="195"/></a></div></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">    Proiorty Selector 优选选择节点    此节点下属所有节点依次执行直到返回success</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824368173643.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [5].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[5]" width="244"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">    Random Selector 随机选择节点    此节点下属所有节点随机执行直到其中某一个返回success</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824380044713.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [6].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[6]" width="244"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">    Ramdom Sequence 随机选择列队节点    此节点下属所有节点随机执行直到其中一个返回false</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824389891014.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [7].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[7]" width="244"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">    Selector 选择节点   此节点下属所有节点依次执行直到返回true</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824400043369.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [8].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[8]" width="244"/></a></div><div><br/></div><div style="text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">    Selector Evaluator 计算选择节点(姑且这样叫把，这个名词翻译的有点拗口)    此节点下属所有节点依次执行直到返回success，有一种情况使其返回running状态并中断，就是有节点被打勾了</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824410676411.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [9].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[9]" width="234"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">   Sequence 顺序节点  此节点下属所有节点依次执行直到返回false</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824423791210.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [10].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[10]" width="224"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-weight: bold;">Decorators</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        装饰节点应为Composites的分支节点，而装饰节点一般用来修饰判断，比如这个修饰可以是 “直到...成功”，“直到...失败”</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824435201996.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [11].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[11]" width="244"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        Conditional Evaluator   条件计算节点  此节点下属节点执行直到返回success，有一种情况使其返回running状态并中断，就是有节点被打勾了</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824443012123.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [12].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[12]" width="114"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        Interrupt 中断(开关)节点 此节点第一次执行为true第二次为false </span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824458647079.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [13].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[13]" width="236"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        Inverter 逆变节点 此节点的子节点如返回success他可将结果改为false反之也可</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824474421564.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [14].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[14]" width="159"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        Repeater 重复节点    此节点可设置该节点下子节点重复执行的次数</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824490041819.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [15].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[15]" width="147"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        Return Failure / Return Success  我就不解释了</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        Task Guard Task意为任务Guard意为守卫，那么这个节点是告诉我们可以用他来限定该节点的子节点不能同时被两项或以上的任务访问，换而言之该节点可以设置它的子节点能同时被几个任务(其余的节点)访问，类似于多线程访问统一资源我们所使用的Lock。</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        Until Fuilure /  Until Success 直到...返回false/知道...返回Success 这两项我想也没有必要说明了，但看字面上的意思足够说明一切了。</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-weight: bold;">Actions</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        动作或行为，如“攻击” “追逐”</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824502239347.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [16].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[16]" width="244"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        Action有三大类，第一类为基础的API，第二类为基本的Monobehavior操作 如Animator，Animation，Behavior 等等，第三类为辅助API 都是使用反射处理，当然这个大类隐含着性能的损耗要谨慎使用</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        此处仅选必要的API解释，其余的相信你可以看懂</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        Behavior Tree Reference 此节点允许此节点的脚本中重写GetExternalBehaviors方法，也就是你可以在运行时指定一个行为树在当前节点下运行！(动态指定行为树)</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        Preform Interuption 此节点允许用户中断在节点列表中添加的任务(可以有很多任务)</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        Restart Behavior Tree 重启行为树</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        Stop Behavior Tree 终止行为树</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        另外 Action 一般我们程序需要扩展给策划配置 后文将提到如何自行扩展Action。</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-weight: bold;">Conditionals</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        用于条件对比，例如 “是否为空” “是否是处于某状态”  “是否接收到消息” “是否等于某数值”</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824509262732.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [17].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[17]" width="244"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        作为行为树组建中最容易理解的Conditionals，在其基本API中大多以 &quot;Is has XXX&quot; 开头，顾名思义即可</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-weight: bold;">如何扩展(程序)</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-weight: bold;">创建一个自定义行为(Action)或是节点</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824516761103.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [18].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[18]" width="244"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        相关文档</span></div><div><br/></div><div style="text-align: left;"><a href="http://www.opsive.com/assets/BehaviorDesigner/documentation.php?id=5" style="background-color: rgb(255, 255, 255); font-size: 16px; color: black; font-family: Verdana, Arial, Helvetica, sans-serif; text-decoration: underline;">http://www.opsive.com/assets/BehaviorDesigner/documentation.php?id=5</a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-weight: bold;">使用运行时(Runtime)设置的数值</span></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        在编辑器中设置的数值有两种：一种是在使用功能性节点的时候节点中需要预设的数值，另一种是全局可访问到的数值</span></div><div><br/></div><div style="text-align: left;"><div><a href="http://images0.cnblogs.com/blog/545402/201508/131824527394146.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [19].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[19]" width="244"/></a></div><div><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;"> 添加wait节点的暂停时间</span></div></div><div><br/></div><div style="text-align: left;"><div><a href="http://images0.cnblogs.com/blog/545402/201508/131824533327032.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [20].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[20]" width="244"/></a></div><div><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;"> 添加全局可访问的数值</span></div></div><div><br/></div><div style="text-align: left;"><div><a href="http://images0.cnblogs.com/blog/545402/201508/131824543177630.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [21].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[21]" width="244"/></a></div><div><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;"> 非运行时可以使用刚才设置的float数值</span></div></div><div><br/></div><div style="text-align: left;"><div><a href="http://images0.cnblogs.com/blog/545402/201508/131824550201016.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [22].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[22]" width="244"/></a></div><div><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">   当然也可使用全局数值</span></div></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif;">        说完了使用编辑器访问数值现在该使用运行时动态获取这些数值了，代码很简单</span></div><div><br/></div><div style="text-align: left;"><a href="http://images0.cnblogs.com/blog/545402/201508/131824557396629.png"><img src="Unity行为树插件（Behavior Designer）_files/Image [23].png" type="image/png" data-filename="Image.png" style="cursor: default; height: auto;" title="clipboard[23]" width="244"/></a></div><div><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; font-family: Verdana, Arial, Helvetica, sans-serif;">        相关文档  </span></div><div style="text-align: left;"><a href="http://www.opsive.com/assets/BehaviorDesigner/documentation.php?id=54" style="background-color: rgb(255, 255, 255); font-size: 16px; font-family: Verdana, Arial, Helvetica, sans-serif;">http://www.opsive.com/assets/BehaviorDesigner/documentation.php?id=54</a></div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px;">3. 行为树基类API</span></div><div style="text-align: left;"><span style="background-color: rgb(247, 247, 247); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, sans-serif;">At the highest level a behavior tree is a collection of tasks. Tasks have a similar API to Unity’s MonoBehaviour so it should be really easy to get started </span><a href="http://www.opsive.com/assets/BehaviorDesigner/documentation.php?id=5" style="background-color: rgb(247, 247, 247); font-size: 16px; color: rgb(22, 152, 243); font-family: Verdana, Arial, sans-serif;">writing your own tasks</a><span style="background-color: rgb(247, 247, 247); font-size: 16px; color: rgb(0, 0, 0); font-family: Verdana, Arial, sans-serif;">. The task class has the following API:</span></div><div style="text-align: left;"><span style="background-color: rgb(247, 247, 247); font-size: 16px; font-family: Verdana, Arial, sans-serif;">最高级别的行为树是任务的集合。任务类似Unity的MonoBehaviour，所以应该很容易上手编写自己的任务。任务类具有以下API：</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 128, 0); font-style: italic;">// OnAwake is called once when the behavior tree is enabled. Think of it as a constructor</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">public</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">virtual</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255);">void</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">OnAwake</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;">();</span></div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 128, 0); font-style: italic;">// OnStart is called immediately before execution. It is used to setup any variables that need to be reset from the previous run</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">public</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">virtual</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255);">void</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">OnStart</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;">();</span></div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 128, 0); font-style: italic;">// OnUpdate runs the actual task</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">public</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">virtual</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> TaskStatus </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">OnUpdate</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;">();</span></div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 128, 0); font-style: italic;">// OnEnd is called after execution on a success or failure.</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">public</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">virtual</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255);">void</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">OnEnd</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;">();</span></div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 128, 0); font-style: italic;">// OnPause is called when the behavior is paused and resumed</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">public</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">virtual</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255);">void</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">OnPause</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;">(</span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255);">bool</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> paused);</span></div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 128, 0); font-style: italic;">// The priority select will need to know this tasks priority of running</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">public</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">virtual</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255);">float</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">GetPriority</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;">();</span></div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 128, 0); font-style: italic;">// OnBehaviorComplete is called after the behavior tree finishes executing</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">public</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">virtual</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255);">void</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">OnBehaviorComplete</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;">();</span></div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 128, 0); font-style: italic;">// OnReset is called by the inspector to reset the public properties</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">public</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">virtual</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255);">void</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">OnReset</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;">();</span></div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 128, 0); font-style: italic;">// Allow OnDrawGizmos to be called from the tasks</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">public</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">virtual</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255);">void</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">OnDrawGizmos</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;">();</span></div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 128, 0); font-style: italic;">// Keep a reference to the behavior that owns this task</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">public</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> Behavior Owner;</span></div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px;">在执行任务时，执行下图的流程：</span></div><div style="text-align: left;"><img src="Unity行为树插件（Behavior Designer）_files/Image [24].png" type="image/png" data-filename="Image.png"/></div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px;">4. 局部变量和全局变量</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px;">局部变量：</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255);">using</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> UnityEngine;</span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255);">using</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> BehaviorDesigner.Runtime;</span></div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">public</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">class</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> AccessVariable : MonoBehaviour</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px;">{</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px;">   </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">public</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> BehaviorTree behaviorTree;</span></div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px;">   </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">public</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255);">void</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;"> </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">Start</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;">()</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px;">   {</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px;">      var myIntVariable = (SharedInt)behaviorTree.</span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">GetVariable</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;">(</span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">&quot;MyVariable&quot;</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;">);</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px;">      myIntVariable.Value = </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">42</span><span style="background-color: rgb(255, 255, 255); font-size: 16px;">;</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px;">   }}</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px;">全局变量：</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">GlobalVariables.Instance.</span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">GetVariable</span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">(</span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">&quot;MyVariable&quot;</span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">);</span></div><div style="text-align: left;"><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">GlobalVariables.Instance.</span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">SetVariable</span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">(</span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">&quot;MyVariable&quot;</span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">, </span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 255); font-weight: bold;">value</span><span style="background-color: rgb(255, 255, 255); font-size: 16px; color: rgb(0, 0, 0);">);</span></div></span>
</div></body></html> 